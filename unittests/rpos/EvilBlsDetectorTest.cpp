#define BOOST_TEST_MODULE evilblsdetector_unittest
#include <boost/test/included/unit_test.hpp>

#include <iostream>

#include <rpos/EvilBlsDetector.h>
#include <rpos/VoterSet.h>
#include <lightclient/CommitteeSet.h>

using namespace ultrainio;


BOOST_AUTO_TEST_SUITE(evilblsdetector_unittest)

    BOOST_AUTO_TEST_CASE(one_evil_in_five) {
        std::string str("0000002c7a5538ae66b840adbc66b21f5da87622eb6633fdd6513bd7725e8d8e 2 0 user.112 5 user.115 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b111 85 user.114 6251a08bcd4c9af80eebe9a579354bc574bf91f4d2cb9e21c236cfe4acb7e5c86447c131149ac7579b65a4c6935515664ffeecfcfa24c735a26b2ce61b1a7c0d 1d2c128ce9008d51e224d932be61bb7464868d9618c054129c309fbfa904e667c9dfad1618aa5453e220eecc20e709381bf579b2f39e133a0bc38ee24b96776700 85 user.113 a20ebd539566995b806ccb47dc37ce6ece7975428173c306d63abc0a45c3fb24884cd700063fc0f199553cd0dfd5b1c7540b8694da5c57060628980742d09403 7b42fe79173cf17c1783e478585d511cafa4afaa7d668c2ca17265402fe77b9e30d4de949bbb529305f1c7449b2223fe4ed99a1cb6fa9452935e541d6439699301 85 user.112 47512da8083b3f3699efcb138327ad840e16c23ff1e78d75e810772ca119002173d8ebbdc7e8fa55ce9e767b5eef15ad7081df417dd6951b3f5b67550d973104 9ba4e810118b3dcace3a9dd1db628ce4eb20926bd6911ecf64021b9b604245b7f757030422eac2ab3f47b1db373b35a2bb208571ed872e11c7ea05e68157ccfb01 85 user.111 b8a8dee70ae95bb3f9331f9784459ee2336b556e0ff344271db68e49393be494ce248d6701935564f4ee512b4d1e81cd1a2ab0381eb8bff5143f810e8911710b a1620fc33d6bfe15e6f9a5f68ae8d99bfe7758d30a65ea48cb1bda65a9dc048ece992f2e13fd01a70fbe73840d1e46eee7971e44a9b9959e8ab155a977fa828300 85 ");
        VoterSet voterSet(str);

        std::string committeeSetStr("user.111 b7e0a16fdca44d4ece1b14d8e7e6207402a6447115ca7d2d7edb08958e6d8ed5 3377255e474a9aa9caa13034d540200914970f98574538d5370d4958fc30a52c6cc2a41bf47b5828483c63e5d0b3d407ab4354c631fc0a57506df9a675d0c1c100 user.112 4031a95071a092eca8646d3999c438bdfde368d4837770755af65a11b4520a48 4d07f24635343f83d99ec2c95a5596d0a830c040e55c9d4273a1bc891501d66ac0b3e1b2ac6639c32f279bdafb8f1f6ee4c71dcb07e066d00e4d3fb4524f066901 user.113 2b43a3d8e0523a85141bbfca41006cf9abc47587d0ff3c46d257551ec05f1677 20d392f9813d86534b8e9547a8f83902c1254ae82a5f59f1cffcaf57cf93fb43dacb03fe12863c9912b0321faadbb4f2d5e353dff4913d1f8b56390d16b94a1701 user.114 b9a55c3c661abd8c539b7a7c05c8176036f87aeeb6b117a138327cfdb374cc23 4f53d674913b202d35b1e864adc35f133e457b78cf572ce3aee8fa95d296e52141e64c4cfc6895217bd63ffdc2263434cf72a89c54d5ca1f98bd1b45c6d671b300 user.115 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300");
        CommitteeSet committeeSet(committeeSetStr);

        EvilBlsDetector detector;
        VoterSet outVoterSet;
        std::vector<AccountName> evilAccounts;
        detector.detect(voterSet, committeeSet, outVoterSet, evilAccounts);
        BOOST_CHECK(evilAccounts.size() == 1);
        BOOST_CHECK(evilAccounts[0] == AccountName("user.115"));
        BOOST_CHECK(outVoterSet.accountPool.size() == 4);
        BlsVoterSet blsVoterSet = outVoterSet.toBlsVoterSet(outVoterSet.accountPool.size());
        BOOST_CHECK(committeeSet.verify(blsVoterSet) == true);
    }

    BOOST_AUTO_TEST_CASE(two_evil_in_five) {
        std::string str("0000002c7a5538ae66b840adbc66b21f5da87622eb6633fdd6513bd7725e8d8e 2 0 user.112 5 user.115 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b111 85 user.114 6251a08bcd4c9af80eebe9a579354bc574bf91f4d2cb9e21c236cfe4acb7e5c86447c131149ac7579b65a4c6935515664ffeecfcfa24c735a26b2ce61b1a7c0d 1d2c128ce9008d51e224d932be61bb7464868d9618c054129c309fbfa904e667c9dfad1618aa5453e220eecc20e709381bf579b2f39e133a0bc38ee24b96776700 85 user.113 a20ebd539566995b806ccb47dc37ce6ece7975428173c306d63abc0a45c3fb24884cd700063fc0f199553cd0dfd5b1c7540b8694da5c57060628980742d09403 7b42fe79173cf17c1783e478585d511cafa4afaa7d668c2ca17265402fe77b9e30d4de949bbb529305f1c7449b2223fe4ed99a1cb6fa9452935e541d6439699301 85 user.112 47512da8083b3f3699efcb138327ad840e16c23ff1e78d75e810772ca119002173d8ebbdc7e8fa55ce9e767b5eef15ad7081df417dd6951b3f5b67550d973104 9ba4e810118b3dcace3a9dd1db628ce4eb20926bd6911ecf64021b9b604245b7f757030422eac2ab3f47b1db373b35a2bb208571ed872e11c7ea05e68157ccfb01 85 user.111 b8a8dee70ae95bb3f9331f9784459ee2336b556e0ff344271db68e49393be494ce248d6701935564f4ee512b4d1e81cd1a2ab0381eb8bff5143f810e8911710b a1620fc33d6bfe15e6f9a5f68ae8d99bfe7758d30a65ea48cb1bda65a9dc048ece992f2e13fd01a70fbe73840d1e46eee7971e44a9b9959e8ab155a977fa828322 85 ");
        VoterSet voterSet(str);

        std::string committeeSetStr("user.111 b7e0a16fdca44d4ece1b14d8e7e6207402a6447115ca7d2d7edb08958e6d8ed5 3377255e474a9aa9caa13034d540200914970f98574538d5370d4958fc30a52c6cc2a41bf47b5828483c63e5d0b3d407ab4354c631fc0a57506df9a675d0c1c100 user.112 4031a95071a092eca8646d3999c438bdfde368d4837770755af65a11b4520a48 4d07f24635343f83d99ec2c95a5596d0a830c040e55c9d4273a1bc891501d66ac0b3e1b2ac6639c32f279bdafb8f1f6ee4c71dcb07e066d00e4d3fb4524f066901 user.113 2b43a3d8e0523a85141bbfca41006cf9abc47587d0ff3c46d257551ec05f1677 20d392f9813d86534b8e9547a8f83902c1254ae82a5f59f1cffcaf57cf93fb43dacb03fe12863c9912b0321faadbb4f2d5e353dff4913d1f8b56390d16b94a1701 user.114 b9a55c3c661abd8c539b7a7c05c8176036f87aeeb6b117a138327cfdb374cc23 4f53d674913b202d35b1e864adc35f133e457b78cf572ce3aee8fa95d296e52141e64c4cfc6895217bd63ffdc2263434cf72a89c54d5ca1f98bd1b45c6d671b300 user.115 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300");
        CommitteeSet committeeSet(committeeSetStr);

        EvilBlsDetector detector;
        VoterSet outVoterSet;
        std::vector<AccountName> evilAccounts;
        detector.detect(voterSet, committeeSet, outVoterSet, evilAccounts);
        BOOST_CHECK(evilAccounts.size() == 2);
        BOOST_CHECK(outVoterSet.empty() == false && outVoterSet.accountPool.size() == 3);
        BlsVoterSet blsVoterSet = outVoterSet.toBlsVoterSet(outVoterSet.accountPool.size());
        BOOST_CHECK(committeeSet.verify(blsVoterSet) == false);
    }

    BOOST_AUTO_TEST_CASE(five_evil_in_five) {
        std::string str("0000002c7a5538ae66b840adbc66b21f5da87622eb6633fdd6513bd7725e8d8e 2 0 user.112 5 user.115 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b555 85 user.114 6251a08bcd4c9af80eebe9a579354bc574bf91f4d2cb9e21c236cfe4acb7e5c86447c131149ac7579b65a4c6935515664ffeecfcfa24c735a26b2ce61b1a7c0d 1d2c128ce9008d51e224d932be61bb7464868d9618c054129c309fbfa904e667c9dfad1618aa5453e220eecc20e709381bf579b2f39e133a0bc38ee24b96776755 85 user.113 a20ebd539566995b806ccb47dc37ce6ece7975428173c306d63abc0a45c3fb24884cd700063fc0f199553cd0dfd5b1c7540b8694da5c57060628980742d09403 7b42fe79173cf17c1783e478585d511cafa4afaa7d668c2ca17265402fe77b9e30d4de949bbb529305f1c7449b2223fe4ed99a1cb6fa9452935e541d6439699555 85 user.112 47512da8083b3f3699efcb138327ad840e16c23ff1e78d75e810772ca119002173d8ebbdc7e8fa55ce9e767b5eef15ad7081df417dd6951b3f5b67550d973104 9ba4e810118b3dcace3a9dd1db628ce4eb20926bd6911ecf64021b9b604245b7f757030422eac2ab3f47b1db373b35a2bb208571ed872e11c7ea05e68157ccf555 85 user.111 b8a8dee70ae95bb3f9331f9784459ee2336b556e0ff344271db68e49393be494ce248d6701935564f4ee512b4d1e81cd1a2ab0381eb8bff5143f810e8911710b a1620fc33d6bfe15e6f9a5f68ae8d99bfe7758d30a65ea48cb1bda65a9dc048ece992f2e13fd01a70fbe73840d1e46eee7971e44a9b9959e8ab155a977fa828355 85 ");
        VoterSet voterSet(str);

        std::string committeeSetStr("user.111 b7e0a16fdca44d4ece1b14d8e7e6207402a6447115ca7d2d7edb08958e6d8ed5 3377255e474a9aa9caa13034d540200914970f98574538d5370d4958fc30a52c6cc2a41bf47b5828483c63e5d0b3d407ab4354c631fc0a57506df9a675d0c1c100 user.112 4031a95071a092eca8646d3999c438bdfde368d4837770755af65a11b4520a48 4d07f24635343f83d99ec2c95a5596d0a830c040e55c9d4273a1bc891501d66ac0b3e1b2ac6639c32f279bdafb8f1f6ee4c71dcb07e066d00e4d3fb4524f066901 user.113 2b43a3d8e0523a85141bbfca41006cf9abc47587d0ff3c46d257551ec05f1677 20d392f9813d86534b8e9547a8f83902c1254ae82a5f59f1cffcaf57cf93fb43dacb03fe12863c9912b0321faadbb4f2d5e353dff4913d1f8b56390d16b94a1701 user.114 b9a55c3c661abd8c539b7a7c05c8176036f87aeeb6b117a138327cfdb374cc23 4f53d674913b202d35b1e864adc35f133e457b78cf572ce3aee8fa95d296e52141e64c4cfc6895217bd63ffdc2263434cf72a89c54d5ca1f98bd1b45c6d671b300 user.115 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300");
        CommitteeSet committeeSet(committeeSetStr);

        EvilBlsDetector detector;
        VoterSet outVoterSet;
        std::vector<AccountName> evilAccounts;
        detector.detect(voterSet, committeeSet, outVoterSet, evilAccounts);
        BOOST_CHECK(evilAccounts.size() == 5);
        BOOST_CHECK(outVoterSet.accountPool.size() == 0);
        BlsVoterSet blsVoterSet = outVoterSet.toBlsVoterSet(outVoterSet.accountPool.size());
        BOOST_CHECK(committeeSet.verify(blsVoterSet) == false);
    }

    BOOST_AUTO_TEST_CASE(zero_evil_in_ten) {
        std::string str("0000002c7a5538ae66b840adbc66b21f5da87622eb6633fdd6513bd7725e8d8e 2 0 user.112 10 user.125 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.124 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.123 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.122 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.121 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.115 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.114 6251a08bcd4c9af80eebe9a579354bc574bf91f4d2cb9e21c236cfe4acb7e5c86447c131149ac7579b65a4c6935515664ffeecfcfa24c735a26b2ce61b1a7c0d 1d2c128ce9008d51e224d932be61bb7464868d9618c054129c309fbfa904e667c9dfad1618aa5453e220eecc20e709381bf579b2f39e133a0bc38ee24b96776700 85 user.113 a20ebd539566995b806ccb47dc37ce6ece7975428173c306d63abc0a45c3fb24884cd700063fc0f199553cd0dfd5b1c7540b8694da5c57060628980742d09403 7b42fe79173cf17c1783e478585d511cafa4afaa7d668c2ca17265402fe77b9e30d4de949bbb529305f1c7449b2223fe4ed99a1cb6fa9452935e541d6439699301 85 user.112 47512da8083b3f3699efcb138327ad840e16c23ff1e78d75e810772ca119002173d8ebbdc7e8fa55ce9e767b5eef15ad7081df417dd6951b3f5b67550d973104 9ba4e810118b3dcace3a9dd1db628ce4eb20926bd6911ecf64021b9b604245b7f757030422eac2ab3f47b1db373b35a2bb208571ed872e11c7ea05e68157ccfb01 85 user.111 b8a8dee70ae95bb3f9331f9784459ee2336b556e0ff344271db68e49393be494ce248d6701935564f4ee512b4d1e81cd1a2ab0381eb8bff5143f810e8911710b a1620fc33d6bfe15e6f9a5f68ae8d99bfe7758d30a65ea48cb1bda65a9dc048ece992f2e13fd01a70fbe73840d1e46eee7971e44a9b9959e8ab155a977fa828300 85 ");
        VoterSet voterSet(str);
        std::string committeeSetStr("user.111 b7e0a16fdca44d4ece1b14d8e7e6207402a6447115ca7d2d7edb08958e6d8ed5 3377255e474a9aa9caa13034d540200914970f98574538d5370d4958fc30a52c6cc2a41bf47b5828483c63e5d0b3d407ab4354c631fc0a57506df9a675d0c1c100 user.112 4031a95071a092eca8646d3999c438bdfde368d4837770755af65a11b4520a48 4d07f24635343f83d99ec2c95a5596d0a830c040e55c9d4273a1bc891501d66ac0b3e1b2ac6639c32f279bdafb8f1f6ee4c71dcb07e066d00e4d3fb4524f066901 user.113 2b43a3d8e0523a85141bbfca41006cf9abc47587d0ff3c46d257551ec05f1677 20d392f9813d86534b8e9547a8f83902c1254ae82a5f59f1cffcaf57cf93fb43dacb03fe12863c9912b0321faadbb4f2d5e353dff4913d1f8b56390d16b94a1701 user.114 b9a55c3c661abd8c539b7a7c05c8176036f87aeeb6b117a138327cfdb374cc23 4f53d674913b202d35b1e864adc35f133e457b78cf572ce3aee8fa95d296e52141e64c4cfc6895217bd63ffdc2263434cf72a89c54d5ca1f98bd1b45c6d671b300 user.115 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.121 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.122 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.123 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.124 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.125 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300");
        CommitteeSet committeeSet(committeeSetStr);
        EvilBlsDetector detector;
        VoterSet outVoterSet;
        std::vector<AccountName> evilAccounts;
        detector.detect(voterSet, committeeSet, outVoterSet, evilAccounts);
        BOOST_CHECK(evilAccounts.size() == 0);
        BOOST_CHECK(outVoterSet.accountPool.size() == 10);
        BlsVoterSet blsVoterSet = outVoterSet.toBlsVoterSet(outVoterSet.accountPool.size());
        BOOST_CHECK(committeeSet.verify(blsVoterSet) == true);
    }

    BOOST_AUTO_TEST_CASE(one_evil_in_ten_case_1) {
        std::string str("0000002c7a5538ae66b840adbc66b21f5da87622eb6633fdd6513bd7725e8d8e 2 0 user.112 10 user.125 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b777 85 user.124 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.123 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.122 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.121 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.115 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.114 6251a08bcd4c9af80eebe9a579354bc574bf91f4d2cb9e21c236cfe4acb7e5c86447c131149ac7579b65a4c6935515664ffeecfcfa24c735a26b2ce61b1a7c0d 1d2c128ce9008d51e224d932be61bb7464868d9618c054129c309fbfa904e667c9dfad1618aa5453e220eecc20e709381bf579b2f39e133a0bc38ee24b96776700 85 user.113 a20ebd539566995b806ccb47dc37ce6ece7975428173c306d63abc0a45c3fb24884cd700063fc0f199553cd0dfd5b1c7540b8694da5c57060628980742d09403 7b42fe79173cf17c1783e478585d511cafa4afaa7d668c2ca17265402fe77b9e30d4de949bbb529305f1c7449b2223fe4ed99a1cb6fa9452935e541d6439699301 85 user.112 47512da8083b3f3699efcb138327ad840e16c23ff1e78d75e810772ca119002173d8ebbdc7e8fa55ce9e767b5eef15ad7081df417dd6951b3f5b67550d973104 9ba4e810118b3dcace3a9dd1db628ce4eb20926bd6911ecf64021b9b604245b7f757030422eac2ab3f47b1db373b35a2bb208571ed872e11c7ea05e68157ccfb01 85 user.111 b8a8dee70ae95bb3f9331f9784459ee2336b556e0ff344271db68e49393be494ce248d6701935564f4ee512b4d1e81cd1a2ab0381eb8bff5143f810e8911710b a1620fc33d6bfe15e6f9a5f68ae8d99bfe7758d30a65ea48cb1bda65a9dc048ece992f2e13fd01a70fbe73840d1e46eee7971e44a9b9959e8ab155a977fa828300 85 ");
        VoterSet voterSet(str);
        std::string committeeSetStr("user.111 b7e0a16fdca44d4ece1b14d8e7e6207402a6447115ca7d2d7edb08958e6d8ed5 3377255e474a9aa9caa13034d540200914970f98574538d5370d4958fc30a52c6cc2a41bf47b5828483c63e5d0b3d407ab4354c631fc0a57506df9a675d0c1c100 user.112 4031a95071a092eca8646d3999c438bdfde368d4837770755af65a11b4520a48 4d07f24635343f83d99ec2c95a5596d0a830c040e55c9d4273a1bc891501d66ac0b3e1b2ac6639c32f279bdafb8f1f6ee4c71dcb07e066d00e4d3fb4524f066901 user.113 2b43a3d8e0523a85141bbfca41006cf9abc47587d0ff3c46d257551ec05f1677 20d392f9813d86534b8e9547a8f83902c1254ae82a5f59f1cffcaf57cf93fb43dacb03fe12863c9912b0321faadbb4f2d5e353dff4913d1f8b56390d16b94a1701 user.114 b9a55c3c661abd8c539b7a7c05c8176036f87aeeb6b117a138327cfdb374cc23 4f53d674913b202d35b1e864adc35f133e457b78cf572ce3aee8fa95d296e52141e64c4cfc6895217bd63ffdc2263434cf72a89c54d5ca1f98bd1b45c6d671b300 user.115 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.121 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.122 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.123 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.124 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.125 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300");
        CommitteeSet committeeSet(committeeSetStr);
        EvilBlsDetector detector;
        VoterSet outVoterSet;
        std::vector<AccountName> evilAccounts;
        detector.detect(voterSet, committeeSet, outVoterSet, evilAccounts);
        BOOST_CHECK(evilAccounts.size() == 1);
        BOOST_CHECK(outVoterSet.accountPool.size() == 9);
        BlsVoterSet blsVoterSet = outVoterSet.toBlsVoterSet(outVoterSet.accountPool.size());
        BOOST_CHECK(committeeSet.verify(blsVoterSet) == true);
    }

    BOOST_AUTO_TEST_CASE(one_evil_in_ten_case_2) {
        std::string str("0000002c7a5538ae66b840adbc66b21f5da87622eb6633fdd6513bd7725e8d8e 2 0 user.112 10 user.125 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.124 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.123 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.122 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.121 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b777 85 user.115 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.114 6251a08bcd4c9af80eebe9a579354bc574bf91f4d2cb9e21c236cfe4acb7e5c86447c131149ac7579b65a4c6935515664ffeecfcfa24c735a26b2ce61b1a7c0d 1d2c128ce9008d51e224d932be61bb7464868d9618c054129c309fbfa904e667c9dfad1618aa5453e220eecc20e709381bf579b2f39e133a0bc38ee24b96776700 85 user.113 a20ebd539566995b806ccb47dc37ce6ece7975428173c306d63abc0a45c3fb24884cd700063fc0f199553cd0dfd5b1c7540b8694da5c57060628980742d09403 7b42fe79173cf17c1783e478585d511cafa4afaa7d668c2ca17265402fe77b9e30d4de949bbb529305f1c7449b2223fe4ed99a1cb6fa9452935e541d6439699301 85 user.112 47512da8083b3f3699efcb138327ad840e16c23ff1e78d75e810772ca119002173d8ebbdc7e8fa55ce9e767b5eef15ad7081df417dd6951b3f5b67550d973104 9ba4e810118b3dcace3a9dd1db628ce4eb20926bd6911ecf64021b9b604245b7f757030422eac2ab3f47b1db373b35a2bb208571ed872e11c7ea05e68157ccfb01 85 user.111 b8a8dee70ae95bb3f9331f9784459ee2336b556e0ff344271db68e49393be494ce248d6701935564f4ee512b4d1e81cd1a2ab0381eb8bff5143f810e8911710b a1620fc33d6bfe15e6f9a5f68ae8d99bfe7758d30a65ea48cb1bda65a9dc048ece992f2e13fd01a70fbe73840d1e46eee7971e44a9b9959e8ab155a977fa828300 85 ");
        VoterSet voterSet(str);
        std::string committeeSetStr("user.111 b7e0a16fdca44d4ece1b14d8e7e6207402a6447115ca7d2d7edb08958e6d8ed5 3377255e474a9aa9caa13034d540200914970f98574538d5370d4958fc30a52c6cc2a41bf47b5828483c63e5d0b3d407ab4354c631fc0a57506df9a675d0c1c100 user.112 4031a95071a092eca8646d3999c438bdfde368d4837770755af65a11b4520a48 4d07f24635343f83d99ec2c95a5596d0a830c040e55c9d4273a1bc891501d66ac0b3e1b2ac6639c32f279bdafb8f1f6ee4c71dcb07e066d00e4d3fb4524f066901 user.113 2b43a3d8e0523a85141bbfca41006cf9abc47587d0ff3c46d257551ec05f1677 20d392f9813d86534b8e9547a8f83902c1254ae82a5f59f1cffcaf57cf93fb43dacb03fe12863c9912b0321faadbb4f2d5e353dff4913d1f8b56390d16b94a1701 user.114 b9a55c3c661abd8c539b7a7c05c8176036f87aeeb6b117a138327cfdb374cc23 4f53d674913b202d35b1e864adc35f133e457b78cf572ce3aee8fa95d296e52141e64c4cfc6895217bd63ffdc2263434cf72a89c54d5ca1f98bd1b45c6d671b300 user.115 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.121 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.122 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.123 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.124 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.125 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300");
        CommitteeSet committeeSet(committeeSetStr);
        EvilBlsDetector detector;
        VoterSet outVoterSet;
        std::vector<AccountName> evilAccounts;
        detector.detect(voterSet, committeeSet, outVoterSet, evilAccounts);
        BOOST_CHECK(evilAccounts.size() == 1);
        BOOST_CHECK(outVoterSet.accountPool.size() == 9);
        BlsVoterSet blsVoterSet = outVoterSet.toBlsVoterSet(outVoterSet.accountPool.size());
        BOOST_CHECK(committeeSet.verify(blsVoterSet) == true);
    }

    BOOST_AUTO_TEST_CASE(one_evil_in_ten_case_3) {
        std::string str("0000002c7a5538ae66b840adbc66b21f5da87622eb6633fdd6513bd7725e8d8e 2 0 user.112 10 user.125 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.124 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.123 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.122 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.121 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.115 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b777 85 user.114 6251a08bcd4c9af80eebe9a579354bc574bf91f4d2cb9e21c236cfe4acb7e5c86447c131149ac7579b65a4c6935515664ffeecfcfa24c735a26b2ce61b1a7c0d 1d2c128ce9008d51e224d932be61bb7464868d9618c054129c309fbfa904e667c9dfad1618aa5453e220eecc20e709381bf579b2f39e133a0bc38ee24b96776700 85 user.113 a20ebd539566995b806ccb47dc37ce6ece7975428173c306d63abc0a45c3fb24884cd700063fc0f199553cd0dfd5b1c7540b8694da5c57060628980742d09403 7b42fe79173cf17c1783e478585d511cafa4afaa7d668c2ca17265402fe77b9e30d4de949bbb529305f1c7449b2223fe4ed99a1cb6fa9452935e541d6439699301 85 user.112 47512da8083b3f3699efcb138327ad840e16c23ff1e78d75e810772ca119002173d8ebbdc7e8fa55ce9e767b5eef15ad7081df417dd6951b3f5b67550d973104 9ba4e810118b3dcace3a9dd1db628ce4eb20926bd6911ecf64021b9b604245b7f757030422eac2ab3f47b1db373b35a2bb208571ed872e11c7ea05e68157ccfb01 85 user.111 b8a8dee70ae95bb3f9331f9784459ee2336b556e0ff344271db68e49393be494ce248d6701935564f4ee512b4d1e81cd1a2ab0381eb8bff5143f810e8911710b a1620fc33d6bfe15e6f9a5f68ae8d99bfe7758d30a65ea48cb1bda65a9dc048ece992f2e13fd01a70fbe73840d1e46eee7971e44a9b9959e8ab155a977fa828300 85 ");
        VoterSet voterSet(str);
        std::string committeeSetStr("user.111 b7e0a16fdca44d4ece1b14d8e7e6207402a6447115ca7d2d7edb08958e6d8ed5 3377255e474a9aa9caa13034d540200914970f98574538d5370d4958fc30a52c6cc2a41bf47b5828483c63e5d0b3d407ab4354c631fc0a57506df9a675d0c1c100 user.112 4031a95071a092eca8646d3999c438bdfde368d4837770755af65a11b4520a48 4d07f24635343f83d99ec2c95a5596d0a830c040e55c9d4273a1bc891501d66ac0b3e1b2ac6639c32f279bdafb8f1f6ee4c71dcb07e066d00e4d3fb4524f066901 user.113 2b43a3d8e0523a85141bbfca41006cf9abc47587d0ff3c46d257551ec05f1677 20d392f9813d86534b8e9547a8f83902c1254ae82a5f59f1cffcaf57cf93fb43dacb03fe12863c9912b0321faadbb4f2d5e353dff4913d1f8b56390d16b94a1701 user.114 b9a55c3c661abd8c539b7a7c05c8176036f87aeeb6b117a138327cfdb374cc23 4f53d674913b202d35b1e864adc35f133e457b78cf572ce3aee8fa95d296e52141e64c4cfc6895217bd63ffdc2263434cf72a89c54d5ca1f98bd1b45c6d671b300 user.115 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.121 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.122 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.123 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.124 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.125 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300");
        CommitteeSet committeeSet(committeeSetStr);
        EvilBlsDetector detector;
        VoterSet outVoterSet;
        std::vector<AccountName> evilAccounts;
        detector.detect(voterSet, committeeSet, outVoterSet, evilAccounts);
        BOOST_CHECK(evilAccounts.size() == 1);
        BOOST_CHECK(outVoterSet.accountPool.size() == 9);
        BlsVoterSet blsVoterSet = outVoterSet.toBlsVoterSet(outVoterSet.accountPool.size());
        BOOST_CHECK(committeeSet.verify(blsVoterSet) == true);
    }

    BOOST_AUTO_TEST_CASE(two_evil_in_ten_case_1) {
        std::string str("0000002c7a5538ae66b840adbc66b21f5da87622eb6633fdd6513bd7725e8d8e 2 0 user.112 10 user.125 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.124 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.123 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.122 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.121 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b777 85 user.115 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b777 85 user.114 6251a08bcd4c9af80eebe9a579354bc574bf91f4d2cb9e21c236cfe4acb7e5c86447c131149ac7579b65a4c6935515664ffeecfcfa24c735a26b2ce61b1a7c0d 1d2c128ce9008d51e224d932be61bb7464868d9618c054129c309fbfa904e667c9dfad1618aa5453e220eecc20e709381bf579b2f39e133a0bc38ee24b96776700 85 user.113 a20ebd539566995b806ccb47dc37ce6ece7975428173c306d63abc0a45c3fb24884cd700063fc0f199553cd0dfd5b1c7540b8694da5c57060628980742d09403 7b42fe79173cf17c1783e478585d511cafa4afaa7d668c2ca17265402fe77b9e30d4de949bbb529305f1c7449b2223fe4ed99a1cb6fa9452935e541d6439699301 85 user.112 47512da8083b3f3699efcb138327ad840e16c23ff1e78d75e810772ca119002173d8ebbdc7e8fa55ce9e767b5eef15ad7081df417dd6951b3f5b67550d973104 9ba4e810118b3dcace3a9dd1db628ce4eb20926bd6911ecf64021b9b604245b7f757030422eac2ab3f47b1db373b35a2bb208571ed872e11c7ea05e68157ccfb01 85 user.111 b8a8dee70ae95bb3f9331f9784459ee2336b556e0ff344271db68e49393be494ce248d6701935564f4ee512b4d1e81cd1a2ab0381eb8bff5143f810e8911710b a1620fc33d6bfe15e6f9a5f68ae8d99bfe7758d30a65ea48cb1bda65a9dc048ece992f2e13fd01a70fbe73840d1e46eee7971e44a9b9959e8ab155a977fa828300 85 ");
        VoterSet voterSet(str);
        std::string committeeSetStr("user.111 b7e0a16fdca44d4ece1b14d8e7e6207402a6447115ca7d2d7edb08958e6d8ed5 3377255e474a9aa9caa13034d540200914970f98574538d5370d4958fc30a52c6cc2a41bf47b5828483c63e5d0b3d407ab4354c631fc0a57506df9a675d0c1c100 user.112 4031a95071a092eca8646d3999c438bdfde368d4837770755af65a11b4520a48 4d07f24635343f83d99ec2c95a5596d0a830c040e55c9d4273a1bc891501d66ac0b3e1b2ac6639c32f279bdafb8f1f6ee4c71dcb07e066d00e4d3fb4524f066901 user.113 2b43a3d8e0523a85141bbfca41006cf9abc47587d0ff3c46d257551ec05f1677 20d392f9813d86534b8e9547a8f83902c1254ae82a5f59f1cffcaf57cf93fb43dacb03fe12863c9912b0321faadbb4f2d5e353dff4913d1f8b56390d16b94a1701 user.114 b9a55c3c661abd8c539b7a7c05c8176036f87aeeb6b117a138327cfdb374cc23 4f53d674913b202d35b1e864adc35f133e457b78cf572ce3aee8fa95d296e52141e64c4cfc6895217bd63ffdc2263434cf72a89c54d5ca1f98bd1b45c6d671b300 user.115 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.121 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.122 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.123 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.124 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.125 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300");
        CommitteeSet committeeSet(committeeSetStr);
        EvilBlsDetector detector;
        VoterSet outVoterSet;
        std::vector<AccountName> evilAccounts;
        detector.detect(voterSet, committeeSet, outVoterSet, evilAccounts);
        BOOST_CHECK(evilAccounts.size() == 2);
        BOOST_CHECK(outVoterSet.accountPool.size() == 8);
        BlsVoterSet blsVoterSet = outVoterSet.toBlsVoterSet(outVoterSet.accountPool.size());
        BOOST_CHECK(committeeSet.verify(blsVoterSet) == true);
    }

    BOOST_AUTO_TEST_CASE(two_evil_in_ten_case_2) {
        std::string str("0000002c7a5538ae66b840adbc66b21f5da87622eb6633fdd6513bd7725e8d8e 2 0 user.112 10 user.125 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b777 85 user.124 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.123 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.122 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.121 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b777 85 user.115 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.114 6251a08bcd4c9af80eebe9a579354bc574bf91f4d2cb9e21c236cfe4acb7e5c86447c131149ac7579b65a4c6935515664ffeecfcfa24c735a26b2ce61b1a7c0d 1d2c128ce9008d51e224d932be61bb7464868d9618c054129c309fbfa904e667c9dfad1618aa5453e220eecc20e709381bf579b2f39e133a0bc38ee24b96776700 85 user.113 a20ebd539566995b806ccb47dc37ce6ece7975428173c306d63abc0a45c3fb24884cd700063fc0f199553cd0dfd5b1c7540b8694da5c57060628980742d09403 7b42fe79173cf17c1783e478585d511cafa4afaa7d668c2ca17265402fe77b9e30d4de949bbb529305f1c7449b2223fe4ed99a1cb6fa9452935e541d6439699301 85 user.112 47512da8083b3f3699efcb138327ad840e16c23ff1e78d75e810772ca119002173d8ebbdc7e8fa55ce9e767b5eef15ad7081df417dd6951b3f5b67550d973104 9ba4e810118b3dcace3a9dd1db628ce4eb20926bd6911ecf64021b9b604245b7f757030422eac2ab3f47b1db373b35a2bb208571ed872e11c7ea05e68157ccfb01 85 user.111 b8a8dee70ae95bb3f9331f9784459ee2336b556e0ff344271db68e49393be494ce248d6701935564f4ee512b4d1e81cd1a2ab0381eb8bff5143f810e8911710b a1620fc33d6bfe15e6f9a5f68ae8d99bfe7758d30a65ea48cb1bda65a9dc048ece992f2e13fd01a70fbe73840d1e46eee7971e44a9b9959e8ab155a977fa828300 85 ");
        VoterSet voterSet(str);
        std::string committeeSetStr("user.111 b7e0a16fdca44d4ece1b14d8e7e6207402a6447115ca7d2d7edb08958e6d8ed5 3377255e474a9aa9caa13034d540200914970f98574538d5370d4958fc30a52c6cc2a41bf47b5828483c63e5d0b3d407ab4354c631fc0a57506df9a675d0c1c100 user.112 4031a95071a092eca8646d3999c438bdfde368d4837770755af65a11b4520a48 4d07f24635343f83d99ec2c95a5596d0a830c040e55c9d4273a1bc891501d66ac0b3e1b2ac6639c32f279bdafb8f1f6ee4c71dcb07e066d00e4d3fb4524f066901 user.113 2b43a3d8e0523a85141bbfca41006cf9abc47587d0ff3c46d257551ec05f1677 20d392f9813d86534b8e9547a8f83902c1254ae82a5f59f1cffcaf57cf93fb43dacb03fe12863c9912b0321faadbb4f2d5e353dff4913d1f8b56390d16b94a1701 user.114 b9a55c3c661abd8c539b7a7c05c8176036f87aeeb6b117a138327cfdb374cc23 4f53d674913b202d35b1e864adc35f133e457b78cf572ce3aee8fa95d296e52141e64c4cfc6895217bd63ffdc2263434cf72a89c54d5ca1f98bd1b45c6d671b300 user.115 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.121 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.122 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.123 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.124 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.125 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300");
        CommitteeSet committeeSet(committeeSetStr);
        EvilBlsDetector detector;
        VoterSet outVoterSet;
        std::vector<AccountName> evilAccounts;
        detector.detect(voterSet, committeeSet, outVoterSet, evilAccounts);
        BOOST_CHECK(evilAccounts.size() == 2);
        BOOST_CHECK(outVoterSet.accountPool.size() == 8);
        BlsVoterSet blsVoterSet = outVoterSet.toBlsVoterSet(outVoterSet.accountPool.size());
        BOOST_CHECK(committeeSet.verify(blsVoterSet) == true);
    }

    BOOST_AUTO_TEST_CASE(two_evil_in_ten_case_3) {
        std::string str("0000002c7a5538ae66b840adbc66b21f5da87622eb6633fdd6513bd7725e8d8e 2 0 user.112 10 user.125 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.124 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.123 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.122 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.121 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.115 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b777 85 user.114 6251a08bcd4c9af80eebe9a579354bc574bf91f4d2cb9e21c236cfe4acb7e5c86447c131149ac7579b65a4c6935515664ffeecfcfa24c735a26b2ce61b1a7c0d 1d2c128ce9008d51e224d932be61bb7464868d9618c054129c309fbfa904e667c9dfad1618aa5453e220eecc20e709381bf579b2f39e133a0bc38ee24b96776700 85 user.113 a20ebd539566995b806ccb47dc37ce6ece7975428173c306d63abc0a45c3fb24884cd700063fc0f199553cd0dfd5b1c7540b8694da5c57060628980742d09403 7b42fe79173cf17c1783e478585d511cafa4afaa7d668c2ca17265402fe77b9e30d4de949bbb529305f1c7449b2223fe4ed99a1cb6fa9452935e541d6439699301 85 user.112 47512da8083b3f3699efcb138327ad840e16c23ff1e78d75e810772ca119002173d8ebbdc7e8fa55ce9e767b5eef15ad7081df417dd6951b3f5b67550d973104 9ba4e810118b3dcace3a9dd1db628ce4eb20926bd6911ecf64021b9b604245b7f757030422eac2ab3f47b1db373b35a2bb208571ed872e11c7ea05e68157ccfb01 85 user.111 b8a8dee70ae95bb3f9331f9784459ee2336b556e0ff344271db68e49393be494ce248d6701935564f4ee512b4d1e81cd1a2ab0381eb8bff5143f810e8911710b a1620fc33d6bfe15e6f9a5f68ae8d99bfe7758d30a65ea48cb1bda65a9dc048ece992f2e13fd01a70fbe73840d1e46eee7971e44a9b9959e8ab155a977fa828777 85 ");
        VoterSet voterSet(str);
        std::string committeeSetStr("user.111 b7e0a16fdca44d4ece1b14d8e7e6207402a6447115ca7d2d7edb08958e6d8ed5 3377255e474a9aa9caa13034d540200914970f98574538d5370d4958fc30a52c6cc2a41bf47b5828483c63e5d0b3d407ab4354c631fc0a57506df9a675d0c1c100 user.112 4031a95071a092eca8646d3999c438bdfde368d4837770755af65a11b4520a48 4d07f24635343f83d99ec2c95a5596d0a830c040e55c9d4273a1bc891501d66ac0b3e1b2ac6639c32f279bdafb8f1f6ee4c71dcb07e066d00e4d3fb4524f066901 user.113 2b43a3d8e0523a85141bbfca41006cf9abc47587d0ff3c46d257551ec05f1677 20d392f9813d86534b8e9547a8f83902c1254ae82a5f59f1cffcaf57cf93fb43dacb03fe12863c9912b0321faadbb4f2d5e353dff4913d1f8b56390d16b94a1701 user.114 b9a55c3c661abd8c539b7a7c05c8176036f87aeeb6b117a138327cfdb374cc23 4f53d674913b202d35b1e864adc35f133e457b78cf572ce3aee8fa95d296e52141e64c4cfc6895217bd63ffdc2263434cf72a89c54d5ca1f98bd1b45c6d671b300 user.115 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.121 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.122 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.123 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.124 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.125 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300");
        CommitteeSet committeeSet(committeeSetStr);
        EvilBlsDetector detector;
        VoterSet outVoterSet;
        std::vector<AccountName> evilAccounts;
        detector.detect(voterSet, committeeSet, outVoterSet, evilAccounts);
        BOOST_CHECK(evilAccounts.size() == 2);
        BOOST_CHECK(outVoterSet.accountPool.size() == 8);
        BlsVoterSet blsVoterSet = outVoterSet.toBlsVoterSet(outVoterSet.accountPool.size());
        BOOST_CHECK(committeeSet.verify(blsVoterSet) == true);
    }

    BOOST_AUTO_TEST_CASE(three_evil_in_ten_case_1) {
        std::string str("0000002c7a5538ae66b840adbc66b21f5da87622eb6633fdd6513bd7725e8d8e 2 0 user.112 10 user.125 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b777 85 user.124 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b777 85 user.123 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b777 85 user.122 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.121 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.115 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.114 6251a08bcd4c9af80eebe9a579354bc574bf91f4d2cb9e21c236cfe4acb7e5c86447c131149ac7579b65a4c6935515664ffeecfcfa24c735a26b2ce61b1a7c0d 1d2c128ce9008d51e224d932be61bb7464868d9618c054129c309fbfa904e667c9dfad1618aa5453e220eecc20e709381bf579b2f39e133a0bc38ee24b96776700 85 user.113 a20ebd539566995b806ccb47dc37ce6ece7975428173c306d63abc0a45c3fb24884cd700063fc0f199553cd0dfd5b1c7540b8694da5c57060628980742d09403 7b42fe79173cf17c1783e478585d511cafa4afaa7d668c2ca17265402fe77b9e30d4de949bbb529305f1c7449b2223fe4ed99a1cb6fa9452935e541d6439699301 85 user.112 47512da8083b3f3699efcb138327ad840e16c23ff1e78d75e810772ca119002173d8ebbdc7e8fa55ce9e767b5eef15ad7081df417dd6951b3f5b67550d973104 9ba4e810118b3dcace3a9dd1db628ce4eb20926bd6911ecf64021b9b604245b7f757030422eac2ab3f47b1db373b35a2bb208571ed872e11c7ea05e68157ccfb01 85 user.111 b8a8dee70ae95bb3f9331f9784459ee2336b556e0ff344271db68e49393be494ce248d6701935564f4ee512b4d1e81cd1a2ab0381eb8bff5143f810e8911710b a1620fc33d6bfe15e6f9a5f68ae8d99bfe7758d30a65ea48cb1bda65a9dc048ece992f2e13fd01a70fbe73840d1e46eee7971e44a9b9959e8ab155a977fa828300 85 ");
        VoterSet voterSet(str);
        std::string committeeSetStr("user.111 b7e0a16fdca44d4ece1b14d8e7e6207402a6447115ca7d2d7edb08958e6d8ed5 3377255e474a9aa9caa13034d540200914970f98574538d5370d4958fc30a52c6cc2a41bf47b5828483c63e5d0b3d407ab4354c631fc0a57506df9a675d0c1c100 user.112 4031a95071a092eca8646d3999c438bdfde368d4837770755af65a11b4520a48 4d07f24635343f83d99ec2c95a5596d0a830c040e55c9d4273a1bc891501d66ac0b3e1b2ac6639c32f279bdafb8f1f6ee4c71dcb07e066d00e4d3fb4524f066901 user.113 2b43a3d8e0523a85141bbfca41006cf9abc47587d0ff3c46d257551ec05f1677 20d392f9813d86534b8e9547a8f83902c1254ae82a5f59f1cffcaf57cf93fb43dacb03fe12863c9912b0321faadbb4f2d5e353dff4913d1f8b56390d16b94a1701 user.114 b9a55c3c661abd8c539b7a7c05c8176036f87aeeb6b117a138327cfdb374cc23 4f53d674913b202d35b1e864adc35f133e457b78cf572ce3aee8fa95d296e52141e64c4cfc6895217bd63ffdc2263434cf72a89c54d5ca1f98bd1b45c6d671b300 user.115 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.121 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.122 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.123 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.124 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.125 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300");
        CommitteeSet committeeSet(committeeSetStr);
        EvilBlsDetector detector;
        VoterSet outVoterSet;
        std::vector<AccountName> evilAccounts;
        detector.detect(voterSet, committeeSet, outVoterSet, evilAccounts);
        BOOST_CHECK(evilAccounts.size() == 3);
        BOOST_CHECK(outVoterSet.accountPool.size() == 7);
        BlsVoterSet blsVoterSet = outVoterSet.toBlsVoterSet(outVoterSet.accountPool.size());
        BOOST_CHECK(committeeSet.verify(blsVoterSet) == true);
    }

    BOOST_AUTO_TEST_CASE(four_evil_in_ten_case_1) {
        std::string str("0000002c7a5538ae66b840adbc66b21f5da87622eb6633fdd6513bd7725e8d8e 2 0 user.112 10 user.125 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b777 85 user.124 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b777 85 user.123 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b777 85 user.122 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b777 85 user.121 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.115 946815426c30e746e8cd6b31b6c172fa6843c84f8ffb56d8b96ece7b4d8af3e5549b9036ab48b6b8580a98773820980dd8d613dc72a68c50bf822de4fd218402 673f7a1437e62b52f496c11e0f526c1ffce1754bea23a6b31c49eb923475fe48e10d5dff293076c9a444ac2f036d7a2f682bdd1fad499ec1b3950a87cb65d3b100 85 user.114 6251a08bcd4c9af80eebe9a579354bc574bf91f4d2cb9e21c236cfe4acb7e5c86447c131149ac7579b65a4c6935515664ffeecfcfa24c735a26b2ce61b1a7c0d 1d2c128ce9008d51e224d932be61bb7464868d9618c054129c309fbfa904e667c9dfad1618aa5453e220eecc20e709381bf579b2f39e133a0bc38ee24b96776700 85 user.113 a20ebd539566995b806ccb47dc37ce6ece7975428173c306d63abc0a45c3fb24884cd700063fc0f199553cd0dfd5b1c7540b8694da5c57060628980742d09403 7b42fe79173cf17c1783e478585d511cafa4afaa7d668c2ca17265402fe77b9e30d4de949bbb529305f1c7449b2223fe4ed99a1cb6fa9452935e541d6439699301 85 user.112 47512da8083b3f3699efcb138327ad840e16c23ff1e78d75e810772ca119002173d8ebbdc7e8fa55ce9e767b5eef15ad7081df417dd6951b3f5b67550d973104 9ba4e810118b3dcace3a9dd1db628ce4eb20926bd6911ecf64021b9b604245b7f757030422eac2ab3f47b1db373b35a2bb208571ed872e11c7ea05e68157ccfb01 85 user.111 b8a8dee70ae95bb3f9331f9784459ee2336b556e0ff344271db68e49393be494ce248d6701935564f4ee512b4d1e81cd1a2ab0381eb8bff5143f810e8911710b a1620fc33d6bfe15e6f9a5f68ae8d99bfe7758d30a65ea48cb1bda65a9dc048ece992f2e13fd01a70fbe73840d1e46eee7971e44a9b9959e8ab155a977fa828300 85 ");
        VoterSet voterSet(str);
        std::string committeeSetStr("user.111 b7e0a16fdca44d4ece1b14d8e7e6207402a6447115ca7d2d7edb08958e6d8ed5 3377255e474a9aa9caa13034d540200914970f98574538d5370d4958fc30a52c6cc2a41bf47b5828483c63e5d0b3d407ab4354c631fc0a57506df9a675d0c1c100 user.112 4031a95071a092eca8646d3999c438bdfde368d4837770755af65a11b4520a48 4d07f24635343f83d99ec2c95a5596d0a830c040e55c9d4273a1bc891501d66ac0b3e1b2ac6639c32f279bdafb8f1f6ee4c71dcb07e066d00e4d3fb4524f066901 user.113 2b43a3d8e0523a85141bbfca41006cf9abc47587d0ff3c46d257551ec05f1677 20d392f9813d86534b8e9547a8f83902c1254ae82a5f59f1cffcaf57cf93fb43dacb03fe12863c9912b0321faadbb4f2d5e353dff4913d1f8b56390d16b94a1701 user.114 b9a55c3c661abd8c539b7a7c05c8176036f87aeeb6b117a138327cfdb374cc23 4f53d674913b202d35b1e864adc35f133e457b78cf572ce3aee8fa95d296e52141e64c4cfc6895217bd63ffdc2263434cf72a89c54d5ca1f98bd1b45c6d671b300 user.115 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.121 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.122 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.123 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.124 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300 user.125 8f6e3b3336276138023617f0ae0e6fd0c37d27aa9995f9803fe78df4941dd3ec 8a4e44c5240b45cec1665cbea836887fc96aa6eb5515a0e83f257aa593bb0721cd8b56af9d1f6a8b11bbff1f901186274771d3a7a40b23ae661aad247f1705b300");
        CommitteeSet committeeSet(committeeSetStr);
        EvilBlsDetector detector;
        VoterSet outVoterSet;
        std::vector<AccountName> evilAccounts;
        detector.detect(voterSet, committeeSet, outVoterSet, evilAccounts);
        BOOST_CHECK(evilAccounts.size() == 4);
        BOOST_CHECK(outVoterSet.accountPool.size() == 6);
        BlsVoterSet blsVoterSet = outVoterSet.toBlsVoterSet(outVoterSet.accountPool.size());
        BOOST_CHECK(committeeSet.verify(blsVoterSet) == false);
    }

BOOST_AUTO_TEST_SUITE_END()